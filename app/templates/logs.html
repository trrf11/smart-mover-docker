{% extends "base.html" %}

{% block title %}Logs - Smart Mover{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Logs</h1>
</div>

<!-- Alert container for messages -->
<div id="alert-container"></div>

<!-- Run History -->
<section class="section">
    <div class="section-header">
        <h2 class="section-title">Run History</h2>
    </div>

    <div class="card">
        <div id="run-history-loading" class="empty-state">
            <div class="spinner"></div>
        </div>

        <div id="run-history-empty" class="empty-state hidden">
            <p class="text-muted">No runs yet</p>
        </div>

        <div class="run-history-container">
            <table id="run-history-table" class="run-history-table hidden">
                <thead>
                    <tr>
                        <th class="run-col-time">Time</th>
                        <th class="run-col-mode">Mode</th>
                        <th class="run-col-status">Status</th>
                        <th class="run-col-files">Files</th>
                        <th class="run-col-duration">Duration</th>
                    </tr>
                </thead>
                <tbody id="run-history-body">
                </tbody>
            </table>
        </div>

        <div id="run-pagination" class="run-pagination hidden"></div>
    </div>
</section>

<!-- Logs -->
<section class="section">
    <div class="section-header">
        <h2 class="section-title">Output Log</h2>
    </div>

    <div class="log-controls">
        <div class="log-filter">
            <label for="log-level-filter" class="text-secondary" style="font-size: 0.85rem;">Filter:</label>
            <select id="log-level-filter" class="form-select" style="width: auto; height: 32px;" onchange="loadLogs()">
                <option value="">All</option>
                <option value="INFO">INFO</option>
                <option value="DEBUG">DEBUG</option>
                <option value="ERROR">ERROR</option>
            </select>
        </div>

        <label class="form-checkbox">
            <input type="checkbox" id="auto-refresh" onchange="toggleAutoRefresh()">
            <span>Auto-refresh</span>
        </label>

        <button class="btn btn-sm btn-secondary" onclick="loadLogs()">
            Refresh
        </button>

        <a href="/api/logs/download" class="btn btn-sm btn-ghost" download>
            Download
        </a>

        <button class="btn btn-sm btn-danger" onclick="clearLogs()">
            Clear
        </button>
    </div>

    <div class="log-viewer" style="max-height: 600px;">
        <button class="copy-btn" onclick="copyToClipboard('log-content')" title="Copy to clipboard">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
        </button>
        <div id="log-content" class="log-content"></div>
    </div>

    <p id="log-line-count" class="text-muted mt-1" style="font-size: 0.8rem;">0 lines</p>
</section>
{% endblock %}
